<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 13 Non-constant variance (and other unresolved problems) | STAT 245 Course Notes</title>
  <meta name="description" content="Course notes for the Calvin University course STAT 245, Advanced Data Analysis (a course in applied regression)" />
  <meta name="generator" content="bookdown 0.14 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 13 Non-constant variance (and other unresolved problems) | STAT 245 Course Notes" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="Course notes for the Calvin University course STAT 245, Advanced Data Analysis (a course in applied regression)" />
  <meta name="github-repo" content="stacyderuiter/s245-notes-bookdown" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 13 Non-constant variance (and other unresolved problems) | STAT 245 Course Notes" />
  
  <meta name="twitter:description" content="Course notes for the Calvin University course STAT 245, Advanced Data Analysis (a course in applied regression)" />
  

<meta name="author" content="Stacy DeRuiter, Calvin University" />


<meta name="date" content="2019-12-02" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="zero-inflation.html"/>
<link rel="next" href="random-effects.html"/>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />











<style type="text/css">
a.sourceLine { display: inline-block; line-height: 1.25; }
a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
a.sourceLine:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
a.sourceLine { text-indent: -1em; padding-left: 1em; }
}
pre.numberSource a.sourceLine
  { position: relative; left: -4em; }
pre.numberSource a.sourceLine::before
  { content: attr(title);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; pointer-events: all; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  }
@media screen {
a.sourceLine::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">STAT 245 Notes</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Description</a></li>
<li class="chapter" data-level="2" data-path="linear-regression.html"><a href="linear-regression.html"><i class="fa fa-check"></i><b>2</b> Linear Regression</a><ul>
<li class="chapter" data-level="2.1" data-path="linear-regression.html"><a href="linear-regression.html#data"><i class="fa fa-check"></i><b>2.1</b> Data</a></li>
<li class="chapter" data-level="2.2" data-path="linear-regression.html"><a href="linear-regression.html#simple-linear-regression-residuals-least-squares"><i class="fa fa-check"></i><b>2.2</b> Simple linear regression, Residuals &amp; Least squares</a><ul>
<li class="chapter" data-level="2.2.1" data-path="linear-regression.html"><a href="linear-regression.html#using-lm-to-fit-a-linear-regression-in-r"><i class="fa fa-check"></i><b>2.2.1</b> Using <code>lm()</code> to fit a linear regression in R</a></li>
<li class="chapter" data-level="2.2.2" data-path="linear-regression.html"><a href="linear-regression.html#equation-of-the-fitted-regression-line"><i class="fa fa-check"></i><b>2.2.2</b> Equation of the fitted regression line</a></li>
</ul></li>
<li class="chapter" data-level="2.3" data-path="linear-regression.html"><a href="linear-regression.html#multiple-regression"><i class="fa fa-check"></i><b>2.3</b> Multiple regression</a><ul>
<li class="chapter" data-level="2.3.1" data-path="linear-regression.html"><a href="linear-regression.html#is-it-really-better"><i class="fa fa-check"></i><b>2.3.1</b> Is it really better?</a></li>
<li class="chapter" data-level="2.3.2" data-path="linear-regression.html"><a href="linear-regression.html#regression-residuals-errors"><i class="fa fa-check"></i><b>2.3.2</b> Regression residuals = “errors”</a></li>
<li class="chapter" data-level="2.3.3" data-path="linear-regression.html"><a href="linear-regression.html#computing-predictions"><i class="fa fa-check"></i><b>2.3.3</b> Computing Predictions</a></li>
</ul></li>
<li class="chapter" data-level="2.4" data-path="linear-regression.html"><a href="linear-regression.html#predictors-with-two-categories"><i class="fa fa-check"></i><b>2.4</b> Predictors with two categories</a><ul>
<li class="chapter" data-level="2.4.1" data-path="linear-regression.html"><a href="linear-regression.html#predictors-with-more-categories"><i class="fa fa-check"></i><b>2.4.1</b> Predictors with more categories</a></li>
</ul></li>
<li class="chapter" data-level="2.5" data-path="linear-regression.html"><a href="linear-regression.html#returning-to-the-r-model-summary"><i class="fa fa-check"></i><b>2.5</b> Returning to the R Model Summary</a></li>
<li class="chapter" data-level="2.6" data-path="linear-regression.html"><a href="linear-regression.html#predictions-from-the-model"><i class="fa fa-check"></i><b>2.6</b> Predictions from the model</a><ul>
<li class="chapter" data-level="2.6.1" data-path="linear-regression.html"><a href="linear-regression.html#by-hand"><i class="fa fa-check"></i><b>2.6.1</b> By Hand</a></li>
<li class="chapter" data-level="2.6.2" data-path="linear-regression.html"><a href="linear-regression.html#prediction-plots-in-r"><i class="fa fa-check"></i><b>2.6.2</b> Prediction Plots in R</a></li>
</ul></li>
<li class="chapter" data-level="2.7" data-path="linear-regression.html"><a href="linear-regression.html#why-are-we-doing-this-again"><i class="fa fa-check"></i><b>2.7</b> Why are we doing this again?</a></li>
<li class="chapter" data-level="2.8" data-path="linear-regression.html"><a href="linear-regression.html#shortcut-method---with-uncertainty"><i class="fa fa-check"></i><b>2.8</b> Shortcut Method - With Uncertainty</a><ul>
<li class="chapter" data-level="2.8.1" data-path="linear-regression.html"><a href="linear-regression.html#anatomy-of-a-confidence-interval"><i class="fa fa-check"></i><b>2.8.1</b> Anatomy of a Confidence Interval</a></li>
</ul></li>
<li class="chapter" data-level="2.9" data-path="linear-regression.html"><a href="linear-regression.html#diy-method"><i class="fa fa-check"></i><b>2.9</b> DIY Method</a><ul>
<li class="chapter" data-level="2.9.1" data-path="linear-regression.html"><a href="linear-regression.html#creating-a-hypothetical-dataset"><i class="fa fa-check"></i><b>2.9.1</b> Creating a hypothetical dataset</a></li>
<li class="chapter" data-level="2.9.2" data-path="linear-regression.html"><a href="linear-regression.html#making-the-plot"><i class="fa fa-check"></i><b>2.9.2</b> Making the plot</a></li>
<li class="chapter" data-level="2.9.3" data-path="linear-regression.html"><a href="linear-regression.html#categorical-predictors"><i class="fa fa-check"></i><b>2.9.3</b> Categorical predictors</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="3" data-path="model-selection-using-information-criteria.html"><a href="model-selection-using-information-criteria.html"><i class="fa fa-check"></i><b>3</b> Model Selection Using Information Criteria</a><ul>
<li class="chapter" data-level="3.1" data-path="model-selection-using-information-criteria.html"><a href="model-selection-using-information-criteria.html#data-and-model"><i class="fa fa-check"></i><b>3.1</b> Data and Model</a></li>
<li class="chapter" data-level="3.2" data-path="model-selection-using-information-criteria.html"><a href="model-selection-using-information-criteria.html#calculations"><i class="fa fa-check"></i><b>3.2</b> Calculations</a></li>
<li class="chapter" data-level="3.3" data-path="model-selection-using-information-criteria.html"><a href="model-selection-using-information-criteria.html#decisions-with-ics"><i class="fa fa-check"></i><b>3.3</b> Decisions with ICs</a></li>
<li class="chapter" data-level="3.4" data-path="model-selection-using-information-criteria.html"><a href="model-selection-using-information-criteria.html#all-possible-subsets-selection"><i class="fa fa-check"></i><b>3.4</b> All-possible-subsets Selection</a></li>
<li class="chapter" data-level="3.5" data-path="model-selection-using-information-criteria.html"><a href="model-selection-using-information-criteria.html#which-ic-should-i-use"><i class="fa fa-check"></i><b>3.5</b> Which IC should I use?</a></li>
<li class="chapter" data-level="3.6" data-path="model-selection-using-information-criteria.html"><a href="model-selection-using-information-criteria.html#quantities-derived-from-aic"><i class="fa fa-check"></i><b>3.6</b> Quantities derived from AIC</a></li>
<li class="chapter" data-level="3.7" data-path="model-selection-using-information-criteria.html"><a href="model-selection-using-information-criteria.html#important-caution"><i class="fa fa-check"></i><b>3.7</b> Important Caution</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="likelihood.html"><a href="likelihood.html"><i class="fa fa-check"></i><b>4</b> Likelihood</a><ul>
<li class="chapter" data-level="4.1" data-path="likelihood.html"><a href="likelihood.html#data-1"><i class="fa fa-check"></i><b>4.1</b> Data</a></li>
<li class="chapter" data-level="4.2" data-path="likelihood.html"><a href="likelihood.html#review---the-normal-probability-density-function-pdf"><i class="fa fa-check"></i><b>4.2</b> Review - the Normal probability density function (PDF)</a></li>
<li class="chapter" data-level="4.3" data-path="likelihood.html"><a href="likelihood.html#a-simple-model"><i class="fa fa-check"></i><b>4.3</b> A simple model</a></li>
<li class="chapter" data-level="4.4" data-path="likelihood.html"><a href="likelihood.html#using-the-model-to-make-predictions"><i class="fa fa-check"></i><b>4.4</b> Using the Model to Make Predictions</a></li>
<li class="chapter" data-level="4.5" data-path="likelihood.html"><a href="likelihood.html#likelihood-to-the-rescue"><i class="fa fa-check"></i><b>4.5</b> Likelihood to the Rescue!</a></li>
<li class="chapter" data-level="4.6" data-path="likelihood.html"><a href="likelihood.html#how-does-this-relate-to-linear-regression"><i class="fa fa-check"></i><b>4.6</b> How does this relate to linear regression?</a><ul>
<li class="chapter" data-level="4.6.1" data-path="likelihood.html"><a href="likelihood.html#model-equation"><i class="fa fa-check"></i><b>4.6.1</b> Model Equation:</a></li>
</ul></li>
<li class="chapter" data-level="4.7" data-path="likelihood.html"><a href="likelihood.html#likelihood-of-a-dataset-given-a-model"><i class="fa fa-check"></i><b>4.7</b> Likelihood of a dataset, given a model</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="pdfs-and-pmfs.html"><a href="pdfs-and-pmfs.html"><i class="fa fa-check"></i><b>5</b> PDFs and PMFs</a><ul>
<li class="chapter" data-level="5.1" data-path="pdfs-and-pmfs.html"><a href="pdfs-and-pmfs.html#beyond-normal"><i class="fa fa-check"></i><b>5.1</b> Beyond Normal</a></li>
<li class="chapter" data-level="5.2" data-path="pdfs-and-pmfs.html"><a href="pdfs-and-pmfs.html#types-of-probability-distributions"><i class="fa fa-check"></i><b>5.2</b> Types of probability distributions</a><ul>
<li class="chapter" data-level="5.2.1" data-path="pdfs-and-pmfs.html"><a href="pdfs-and-pmfs.html#continuous-distributions"><i class="fa fa-check"></i><b>5.2.1</b> Continuous distributions</a></li>
<li class="chapter" data-level="5.2.2" data-path="pdfs-and-pmfs.html"><a href="pdfs-and-pmfs.html#discrete-distributions"><i class="fa fa-check"></i><b>5.2.2</b> Discrete Distributions</a></li>
</ul></li>
<li class="chapter" data-level="5.3" data-path="pdfs-and-pmfs.html"><a href="pdfs-and-pmfs.html#relevant-features-of-distributions"><i class="fa fa-check"></i><b>5.3</b> Relevant Features of Distributions</a></li>
<li class="chapter" data-level="5.4" data-path="pdfs-and-pmfs.html"><a href="pdfs-and-pmfs.html#examples-of-continuous-distributions"><i class="fa fa-check"></i><b>5.4</b> Examples of Continuous Distributions</a><ul>
<li class="chapter" data-level="5.4.1" data-path="pdfs-and-pmfs.html"><a href="pdfs-and-pmfs.html#normal"><i class="fa fa-check"></i><b>5.4.1</b> Normal</a></li>
<li class="chapter" data-level="5.4.2" data-path="pdfs-and-pmfs.html"><a href="pdfs-and-pmfs.html#gamma"><i class="fa fa-check"></i><b>5.4.2</b> Gamma</a></li>
<li class="chapter" data-level="5.4.3" data-path="pdfs-and-pmfs.html"><a href="pdfs-and-pmfs.html#beta"><i class="fa fa-check"></i><b>5.4.3</b> Beta</a></li>
</ul></li>
<li class="chapter" data-level="5.5" data-path="pdfs-and-pmfs.html"><a href="pdfs-and-pmfs.html#examples-of-discrete-distributions"><i class="fa fa-check"></i><b>5.5</b> Examples of Discrete Distributions</a><ul>
<li class="chapter" data-level="5.5.1" data-path="pdfs-and-pmfs.html"><a href="pdfs-and-pmfs.html#binomial"><i class="fa fa-check"></i><b>5.5.1</b> Binomial</a></li>
<li class="chapter" data-level="5.5.2" data-path="pdfs-and-pmfs.html"><a href="pdfs-and-pmfs.html#poisson"><i class="fa fa-check"></i><b>5.5.2</b> Poisson</a></li>
<li class="chapter" data-level="5.5.3" data-path="pdfs-and-pmfs.html"><a href="pdfs-and-pmfs.html#negative-binomial"><i class="fa fa-check"></i><b>5.5.3</b> Negative Binomial</a></li>
<li class="chapter" data-level="5.5.4" data-path="pdfs-and-pmfs.html"><a href="pdfs-and-pmfs.html#a-mixture-distribution-tweedie"><i class="fa fa-check"></i><b>5.5.4</b> A Mixture Distribution: Tweedie</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="6" data-path="regression-for-count-data.html"><a href="regression-for-count-data.html"><i class="fa fa-check"></i><b>6</b> Regression for Count Data</a><ul>
<li class="chapter" data-level="6.1" data-path="regression-for-count-data.html"><a href="regression-for-count-data.html#data-source"><i class="fa fa-check"></i><b>6.1</b> Data Source</a></li>
<li class="chapter" data-level="6.2" data-path="regression-for-count-data.html"><a href="regression-for-count-data.html#a-bad-idea-multiple-linear-regression-model"><i class="fa fa-check"></i><b>6.2</b> A bad idea: multiple linear regression model</a></li>
<li class="chapter" data-level="6.3" data-path="regression-for-count-data.html"><a href="regression-for-count-data.html#problems-with-the-linear-model"><i class="fa fa-check"></i><b>6.3</b> Problems with the linear model</a></li>
<li class="chapter" data-level="6.4" data-path="regression-for-count-data.html"><a href="regression-for-count-data.html#poisson-regression"><i class="fa fa-check"></i><b>6.4</b> Poisson Regression</a><ul>
<li class="chapter" data-level="6.4.1" data-path="regression-for-count-data.html"><a href="regression-for-count-data.html#fitting-the-model"><i class="fa fa-check"></i><b>6.4.1</b> Fitting the Model</a></li>
<li class="chapter" data-level="6.4.2" data-path="regression-for-count-data.html"><a href="regression-for-count-data.html#conditions"><i class="fa fa-check"></i><b>6.4.2</b> Conditions</a></li>
<li class="chapter" data-level="6.4.3" data-path="regression-for-count-data.html"><a href="regression-for-count-data.html#model-assessment"><i class="fa fa-check"></i><b>6.4.3</b> Model Assessment</a></li>
<li class="chapter" data-level="6.4.4" data-path="regression-for-count-data.html"><a href="regression-for-count-data.html#checking-for-overdispersion-using-overdispersion-factor"><i class="fa fa-check"></i><b>6.4.4</b> Checking for overdispersion using overdispersion factor</a></li>
</ul></li>
<li class="chapter" data-level="6.5" data-path="regression-for-count-data.html"><a href="regression-for-count-data.html#accounting-for-overdispersion-negative-binomial-models"><i class="fa fa-check"></i><b>6.5</b> Accounting for overdispersion: Negative Binomial Models</a></li>
<li class="chapter" data-level="6.6" data-path="regression-for-count-data.html"><a href="regression-for-count-data.html#accounting-for-overdispersion-quasi-poisson-model"><i class="fa fa-check"></i><b>6.6</b> Accounting for overdispersion: quasi-Poisson Model</a></li>
<li class="chapter" data-level="6.7" data-path="regression-for-count-data.html"><a href="regression-for-count-data.html#model-selection-with-dredge-and-qaic-bic"><i class="fa fa-check"></i><b>6.7</b> Model selection with dredge() and (Q)AIC, BIC</a><ul>
<li class="chapter" data-level="6.7.1" data-path="regression-for-count-data.html"><a href="regression-for-count-data.html#review-all-subsets-selection-with-dredge"><i class="fa fa-check"></i><b>6.7.1</b> Review: all subsets selection with dredge()</a></li>
<li class="chapter" data-level="6.7.2" data-path="regression-for-count-data.html"><a href="regression-for-count-data.html#review-ic-weights"><i class="fa fa-check"></i><b>6.7.2</b> Review: IC “weights”</a></li>
<li class="chapter" data-level="6.7.3" data-path="regression-for-count-data.html"><a href="regression-for-count-data.html#extending-dredge-to-quasi-likelihood"><i class="fa fa-check"></i><b>6.7.3</b> Extending dredge() to quasi-Likelihood</a></li>
</ul></li>
<li class="chapter" data-level="6.8" data-path="regression-for-count-data.html"><a href="regression-for-count-data.html#offsets"><i class="fa fa-check"></i><b>6.8</b> Offsets</a></li>
<li class="chapter" data-level="6.9" data-path="regression-for-count-data.html"><a href="regression-for-count-data.html#prediction-plots"><i class="fa fa-check"></i><b>6.9</b> Prediction Plots</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="model-averaging.html"><a href="model-averaging.html"><i class="fa fa-check"></i><b>7</b> Model Averaging</a><ul>
<li class="chapter" data-level="7.1" data-path="model-averaging.html"><a href="model-averaging.html#data-school-survey-on-crime-and-safety"><i class="fa fa-check"></i><b>7.1</b> Data: School Survey on Crime and Safety</a></li>
<li class="chapter" data-level="7.2" data-path="model-averaging.html"><a href="model-averaging.html#modelling-number-of-violent-incidents-per-school"><i class="fa fa-check"></i><b>7.2</b> Modelling number of violent incidents per school</a></li>
<li class="chapter" data-level="7.3" data-path="model-averaging.html"><a href="model-averaging.html#model-averaging-1"><i class="fa fa-check"></i><b>7.3</b> Model Averaging</a><ul>
<li class="chapter" data-level="7.3.1" data-path="model-averaging.html"><a href="model-averaging.html#getting-the-averaged-model"><i class="fa fa-check"></i><b>7.3.1</b> Getting the Averaged Model</a></li>
<li class="chapter" data-level="7.3.2" data-path="model-averaging.html"><a href="model-averaging.html#getting-predictions-from-the-averaged-model"><i class="fa fa-check"></i><b>7.3.2</b> Getting Predictions from the Averaged Model</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="8" data-path="interactions.html"><a href="interactions.html"><i class="fa fa-check"></i><b>8</b> Interactions</a><ul>
<li class="chapter" data-level="8.1" data-path="interactions.html"><a href="interactions.html#example-quantitative-categorical-interaction"><i class="fa fa-check"></i><b>8.1</b> Example: Quantitative-Categorical Interaction</a></li>
<li class="chapter" data-level="8.2" data-path="interactions.html"><a href="interactions.html#categorical-categorical-interaction-example"><i class="fa fa-check"></i><b>8.2</b> Categorical-Categorical Interaction Example</a></li>
<li class="chapter" data-level="8.3" data-path="interactions.html"><a href="interactions.html#quant-quant-interactions"><i class="fa fa-check"></i><b>8.3</b> Quant-Quant interactions?</a></li>
<li class="chapter" data-level="8.4" data-path="interactions.html"><a href="interactions.html#r-code"><i class="fa fa-check"></i><b>8.4</b> R code</a></li>
<li class="chapter" data-level="8.5" data-path="interactions.html"><a href="interactions.html#cautionary-note"><i class="fa fa-check"></i><b>8.5</b> Cautionary note</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="binary-regression.html"><a href="binary-regression.html"><i class="fa fa-check"></i><b>9</b> Binary Regression</a><ul>
<li class="chapter" data-level="9.1" data-path="binary-regression.html"><a href="binary-regression.html#data-source-1"><i class="fa fa-check"></i><b>9.1</b> Data Source</a></li>
<li class="chapter" data-level="9.2" data-path="binary-regression.html"><a href="binary-regression.html#logistic-regression"><i class="fa fa-check"></i><b>9.2</b> Logistic Regression</a></li>
<li class="chapter" data-level="9.3" data-path="binary-regression.html"><a href="binary-regression.html#checking-the-data-setup"><i class="fa fa-check"></i><b>9.3</b> Checking the data setup</a></li>
<li class="chapter" data-level="9.4" data-path="binary-regression.html"><a href="binary-regression.html#fitting-a-saturated-model"><i class="fa fa-check"></i><b>9.4</b> Fitting a saturated model</a></li>
<li class="chapter" data-level="9.5" data-path="binary-regression.html"><a href="binary-regression.html#link-functions"><i class="fa fa-check"></i><b>9.5</b> Link Functions</a></li>
<li class="chapter" data-level="9.6" data-path="binary-regression.html"><a href="binary-regression.html#conditions-1"><i class="fa fa-check"></i><b>9.6</b> Conditions</a></li>
<li class="chapter" data-level="9.7" data-path="binary-regression.html"><a href="binary-regression.html#model-assessment-plots"><i class="fa fa-check"></i><b>9.7</b> Model Assessment Plots</a></li>
<li class="chapter" data-level="9.8" data-path="binary-regression.html"><a href="binary-regression.html#odds-ratios"><i class="fa fa-check"></i><b>9.8</b> Odds Ratios</a></li>
<li class="chapter" data-level="9.9" data-path="binary-regression.html"><a href="binary-regression.html#model-selection"><i class="fa fa-check"></i><b>9.9</b> Model Selection</a></li>
<li class="chapter" data-level="9.10" data-path="binary-regression.html"><a href="binary-regression.html#prediction-plots-1"><i class="fa fa-check"></i><b>9.10</b> Prediction Plots</a></li>
</ul></li>
<li class="chapter" data-level="10" data-path="binary-regression-data-with-more-than-one-trial-per-row.html"><a href="binary-regression-data-with-more-than-one-trial-per-row.html"><i class="fa fa-check"></i><b>10</b> Binary regression: Data with more than one trial per row</a><ul>
<li class="chapter" data-level="10.1" data-path="binary-regression-data-with-more-than-one-trial-per-row.html"><a href="binary-regression-data-with-more-than-one-trial-per-row.html#data-2"><i class="fa fa-check"></i><b>10.1</b> Data</a></li>
<li class="chapter" data-level="10.2" data-path="binary-regression-data-with-more-than-one-trial-per-row.html"><a href="binary-regression-data-with-more-than-one-trial-per-row.html#checking-the-data-setup-1"><i class="fa fa-check"></i><b>10.2</b> Checking the data setup</a></li>
<li class="chapter" data-level="10.3" data-path="binary-regression-data-with-more-than-one-trial-per-row.html"><a href="binary-regression-data-with-more-than-one-trial-per-row.html#fitting-a-saturated-model-1"><i class="fa fa-check"></i><b>10.3</b> Fitting a saturated model</a></li>
<li class="chapter" data-level="10.4" data-path="binary-regression-data-with-more-than-one-trial-per-row.html"><a href="binary-regression-data-with-more-than-one-trial-per-row.html#checking-linearity"><i class="fa fa-check"></i><b>10.4</b> Checking linearity</a></li>
<li class="chapter" data-level="10.5" data-path="binary-regression-data-with-more-than-one-trial-per-row.html"><a href="binary-regression-data-with-more-than-one-trial-per-row.html#model-assessment-1"><i class="fa fa-check"></i><b>10.5</b> Model Assessment</a></li>
<li class="chapter" data-level="10.6" data-path="binary-regression-data-with-more-than-one-trial-per-row.html"><a href="binary-regression-data-with-more-than-one-trial-per-row.html#model-selection-1"><i class="fa fa-check"></i><b>10.6</b> Model Selection</a></li>
</ul></li>
<li class="chapter" data-level="11" data-path="collinearity-and-multicollinearity.html"><a href="collinearity-and-multicollinearity.html"><i class="fa fa-check"></i><b>11</b> Collinearity and Multicollinearity</a><ul>
<li class="chapter" data-level="11.1" data-path="collinearity-and-multicollinearity.html"><a href="collinearity-and-multicollinearity.html#graphical-checks"><i class="fa fa-check"></i><b>11.1</b> Graphical Checks</a><ul>
<li class="chapter" data-level="11.1.1" data-path="collinearity-and-multicollinearity.html"><a href="collinearity-and-multicollinearity.html#preferred-option-correlation-scatter-plot"><i class="fa fa-check"></i><b>11.1.1</b> Preferred option: Correlation Scatter Plot</a></li>
<li class="chapter" data-level="11.1.2" data-path="collinearity-and-multicollinearity.html"><a href="collinearity-and-multicollinearity.html#another-option-heat-map-of-correlation-coefficients"><i class="fa fa-check"></i><b>11.1.2</b> Another option: Heat map of correlation coefficients</a></li>
<li class="chapter" data-level="11.1.3" data-path="collinearity-and-multicollinearity.html"><a href="collinearity-and-multicollinearity.html#how-to-use-this-information"><i class="fa fa-check"></i><b>11.1.3</b> How to use this information</a></li>
</ul></li>
<li class="chapter" data-level="11.2" data-path="collinearity-and-multicollinearity.html"><a href="collinearity-and-multicollinearity.html#variance-inflation-factors"><i class="fa fa-check"></i><b>11.2</b> Variance Inflation Factors</a><ul>
<li class="chapter" data-level="11.2.1" data-path="collinearity-and-multicollinearity.html"><a href="collinearity-and-multicollinearity.html#quantitative-predictors-vifs"><i class="fa fa-check"></i><b>11.2.1</b> Quantitative predictors (VIFs)</a></li>
<li class="chapter" data-level="11.2.2" data-path="collinearity-and-multicollinearity.html"><a href="collinearity-and-multicollinearity.html#some-categorical-predictors-gvifs"><i class="fa fa-check"></i><b>11.2.2</b> (Some) Categorical Predictors (GVIFs)</a></li>
<li class="chapter" data-level="11.2.3" data-path="collinearity-and-multicollinearity.html"><a href="collinearity-and-multicollinearity.html#rules-of-thumb"><i class="fa fa-check"></i><b>11.2.3</b> Rules of Thumb</a></li>
</ul></li>
<li class="chapter" data-level="11.3" data-path="collinearity-and-multicollinearity.html"><a href="collinearity-and-multicollinearity.html#was-it-worth-it"><i class="fa fa-check"></i><b>11.3</b> Was it worth it?</a></li>
</ul></li>
<li class="chapter" data-level="12" data-path="zero-inflation.html"><a href="zero-inflation.html"><i class="fa fa-check"></i><b>12</b> Zero-Inflation</a><ul>
<li class="chapter" data-level="12.1" data-path="zero-inflation.html"><a href="zero-inflation.html#reference-material"><i class="fa fa-check"></i><b>12.1</b> Reference material</a></li>
<li class="chapter" data-level="12.2" data-path="zero-inflation.html"><a href="zero-inflation.html#data-for-example"><i class="fa fa-check"></i><b>12.2</b> Data for Example</a></li>
<li class="chapter" data-level="12.3" data-path="zero-inflation.html"><a href="zero-inflation.html#visualization"><i class="fa fa-check"></i><b>12.3</b> Visualization?</a></li>
<li class="chapter" data-level="12.4" data-path="zero-inflation.html"><a href="zero-inflation.html#collinearitymulticollinearity"><i class="fa fa-check"></i><b>12.4</b> Collinearity/Multicollinearity?</a></li>
<li class="chapter" data-level="12.5" data-path="zero-inflation.html"><a href="zero-inflation.html#fitting-models"><i class="fa fa-check"></i><b>12.5</b> Fitting models</a><ul>
<li class="chapter" data-level="12.5.1" data-path="zero-inflation.html"><a href="zero-inflation.html#zero-inflated-poisson"><i class="fa fa-check"></i><b>12.5.1</b> Zero-inflated Poisson</a></li>
<li class="chapter" data-level="12.5.2" data-path="zero-inflation.html"><a href="zero-inflation.html#zero-inflated-nb-one-way"><i class="fa fa-check"></i><b>12.5.2</b> Zero-inflated NB: one way</a></li>
<li class="chapter" data-level="12.5.3" data-path="zero-inflation.html"><a href="zero-inflation.html#zero-inflated-negative-binomial-other-way"><i class="fa fa-check"></i><b>12.5.3</b> Zero-inflated negative binomial (other way)</a></li>
<li class="chapter" data-level="12.5.4" data-path="zero-inflation.html"><a href="zero-inflation.html#tweedie-model"><i class="fa fa-check"></i><b>12.5.4</b> Tweedie Model</a></li>
</ul></li>
<li class="chapter" data-level="12.6" data-path="zero-inflation.html"><a href="zero-inflation.html#model-assessment-2"><i class="fa fa-check"></i><b>12.6</b> Model Assessment</a></li>
<li class="chapter" data-level="12.7" data-path="zero-inflation.html"><a href="zero-inflation.html#model-selection-2"><i class="fa fa-check"></i><b>12.7</b> Model Selection?</a><ul>
<li class="chapter" data-level="12.7.1" data-path="zero-inflation.html"><a href="zero-inflation.html#zero-inflation-covariates"><i class="fa fa-check"></i><b>12.7.1</b> Zero inflation covariates</a></li>
<li class="chapter" data-level="12.7.2" data-path="zero-inflation.html"><a href="zero-inflation.html#interaction-terms"><i class="fa fa-check"></i><b>12.7.2</b> Interaction terms</a></li>
<li class="chapter" data-level="12.7.3" data-path="zero-inflation.html"><a href="zero-inflation.html#dredge"><i class="fa fa-check"></i><b>12.7.3</b> Dredge</a></li>
</ul></li>
<li class="chapter" data-level="12.8" data-path="zero-inflation.html"><a href="zero-inflation.html#prediction-plots-2"><i class="fa fa-check"></i><b>12.8</b> Prediction Plots</a></li>
<li class="chapter" data-level="12.9" data-path="zero-inflation.html"><a href="zero-inflation.html#acknowledgements"><i class="fa fa-check"></i><b>12.9</b> Acknowledgements</a></li>
</ul></li>
<li class="chapter" data-level="13" data-path="non-constant-variance-and-other-unresolved-problems.html"><a href="non-constant-variance-and-other-unresolved-problems.html"><i class="fa fa-check"></i><b>13</b> Non-constant variance (and other unresolved problems)</a><ul>
<li class="chapter" data-level="13.0.1" data-path="non-constant-variance-and-other-unresolved-problems.html"><a href="non-constant-variance-and-other-unresolved-problems.html#already-in-our-tool-box-make-sure-the-model-is-right"><i class="fa fa-check"></i><b>13.0.1</b> Already in Our Tool Box: Make sure the model is “right”</a></li>
<li class="chapter" data-level="13.0.2" data-path="non-constant-variance-and-other-unresolved-problems.html"><a href="non-constant-variance-and-other-unresolved-problems.html#already-in-our-tool-box-models-that-estimate-dispersion-parameters"><i class="fa fa-check"></i><b>13.0.2</b> Already in Our Tool Box: Models that estimate dispersion parameters</a></li>
<li class="chapter" data-level="13.0.3" data-path="non-constant-variance-and-other-unresolved-problems.html"><a href="non-constant-variance-and-other-unresolved-problems.html#gamma-glms"><i class="fa fa-check"></i><b>13.0.3</b> Gamma GLMs</a></li>
<li class="chapter" data-level="13.0.4" data-path="non-constant-variance-and-other-unresolved-problems.html"><a href="non-constant-variance-and-other-unresolved-problems.html#beta-glms"><i class="fa fa-check"></i><b>13.0.4</b> Beta GLMs</a></li>
<li class="chapter" data-level="13.0.5" data-path="non-constant-variance-and-other-unresolved-problems.html"><a href="non-constant-variance-and-other-unresolved-problems.html#transformations"><i class="fa fa-check"></i><b>13.0.5</b> Transformations</a></li>
<li class="chapter" data-level="13.0.6" data-path="non-constant-variance-and-other-unresolved-problems.html"><a href="non-constant-variance-and-other-unresolved-problems.html#modelling-non-constant-variance"><i class="fa fa-check"></i><b>13.0.6</b> Modelling non-constant variance</a></li>
</ul></li>
<li class="chapter" data-level="14" data-path="random-effects.html"><a href="random-effects.html"><i class="fa fa-check"></i><b>14</b> Random Effects</a><ul>
<li class="chapter" data-level="14.1" data-path="random-effects.html"><a href="random-effects.html#dataset"><i class="fa fa-check"></i><b>14.1</b> Dataset</a></li>
<li class="chapter" data-level="14.2" data-path="random-effects.html"><a href="random-effects.html#data-exploration"><i class="fa fa-check"></i><b>14.2</b> Data Exploration</a></li>
<li class="chapter" data-level="14.3" data-path="random-effects.html"><a href="random-effects.html#a-base-linear-model"><i class="fa fa-check"></i><b>14.3</b> A Base Linear Model</a><ul>
<li class="chapter" data-level="14.3.1" data-path="random-effects.html"><a href="random-effects.html#model-assessment-3"><i class="fa fa-check"></i><b>14.3.1</b> Model assessment</a></li>
</ul></li>
<li class="chapter" data-level="14.4" data-path="random-effects.html"><a href="random-effects.html#a-random-effects-model"><i class="fa fa-check"></i><b>14.4</b> A Random Effects model</a><ul>
<li class="chapter" data-level="14.4.1" data-path="random-effects.html"><a href="random-effects.html#the-formula"><i class="fa fa-check"></i><b>14.4.1</b> The Formula</a></li>
<li class="chapter" data-level="14.4.2" data-path="random-effects.html"><a href="random-effects.html#the-results"><i class="fa fa-check"></i><b>14.4.2</b> The Results</a></li>
<li class="chapter" data-level="14.4.3" data-path="random-effects.html"><a href="random-effects.html#model-assessment-4"><i class="fa fa-check"></i><b>14.4.3</b> Model Assessment</a></li>
<li class="chapter" data-level="14.4.4" data-path="random-effects.html"><a href="random-effects.html#refinement"><i class="fa fa-check"></i><b>14.4.4</b> Refinement</a></li>
</ul></li>
<li class="chapter" data-level="14.5" data-path="random-effects.html"><a href="random-effects.html#model-selection-for-mixed-models"><i class="fa fa-check"></i><b>14.5</b> Model Selection for Mixed Models</a><ul>
<li class="chapter" data-level="14.5.1" data-path="random-effects.html"><a href="random-effects.html#reml-or-ml"><i class="fa fa-check"></i><b>14.5.1</b> REML or ML?</a></li>
<li class="chapter" data-level="14.5.2" data-path="random-effects.html"><a href="random-effects.html#best-model-so-far"><i class="fa fa-check"></i><b>14.5.2</b> Best model so far:</a></li>
</ul></li>
<li class="chapter" data-level="14.6" data-path="random-effects.html"><a href="random-effects.html#random-slopes"><i class="fa fa-check"></i><b>14.6</b> Random Slopes?</a></li>
<li class="chapter" data-level="14.7" data-path="random-effects.html"><a href="random-effects.html#prediction-plots-3"><i class="fa fa-check"></i><b>14.7</b> Prediction Plots</a><ul>
<li class="chapter" data-level="14.7.1" data-path="random-effects.html"><a href="random-effects.html#parametric-bootstrap-to-the-rescue"><i class="fa fa-check"></i><b>14.7.1</b> Parametric bootstrap to the rescue!</a></li>
</ul></li>
<li class="chapter" data-level="14.8" data-path="random-effects.html"><a href="random-effects.html#random-effects-with-glmmtmb-and-standardized-residuals"><i class="fa fa-check"></i><b>14.8</b> Random effects with glmmTMB and standardized residuals</a></li>
<li class="chapter" data-level="14.9" data-path="random-effects.html"><a href="random-effects.html#model-for-whale-dive-duration"><i class="fa fa-check"></i><b>14.9</b> Model for whale dive duration</a></li>
<li class="chapter" data-level="14.10" data-path="random-effects.html"><a href="random-effects.html#glmmtmb"><i class="fa fa-check"></i><b>14.10</b> glmmTMB</a></li>
<li class="chapter" data-level="14.11" data-path="random-effects.html"><a href="random-effects.html#model-assessment-with-scaled-residuals"><i class="fa fa-check"></i><b>14.11</b> Model assessment with scaled residuals</a><ul>
<li class="chapter" data-level="14.11.1" data-path="random-effects.html"><a href="random-effects.html#glmmtmb-version"><i class="fa fa-check"></i><b>14.11.1</b> glmmTMB version</a></li>
<li class="chapter" data-level="14.11.2" data-path="random-effects.html"><a href="random-effects.html#you-now-have-the-power"><i class="fa fa-check"></i><b>14.11.2</b> You now have the power!</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="15" data-path="gees.html"><a href="gees.html"><i class="fa fa-check"></i><b>15</b> GEEs</a><ul>
<li class="chapter" data-level="15.1" data-path="gees.html"><a href="gees.html#data-source-2"><i class="fa fa-check"></i><b>15.1</b> Data Source</a></li>
<li class="chapter" data-level="15.2" data-path="gees.html"><a href="gees.html#data-exploration-1"><i class="fa fa-check"></i><b>15.2</b> Data Exploration</a></li>
<li class="chapter" data-level="15.3" data-path="gees.html"><a href="gees.html#linear-regression-1"><i class="fa fa-check"></i><b>15.3</b> Linear Regression</a></li>
<li class="chapter" data-level="15.4" data-path="gees.html"><a href="gees.html#model-assessment-5"><i class="fa fa-check"></i><b>15.4</b> Model Assessment</a></li>
<li class="chapter" data-level="15.5" data-path="gees.html"><a href="gees.html#linear-regression-2"><i class="fa fa-check"></i><b>15.5</b> Linear Regression</a></li>
<li class="chapter" data-level="15.6" data-path="gees.html"><a href="gees.html#generalized-estimating-equations-gees"><i class="fa fa-check"></i><b>15.6</b> Generalized Estimating Equations (GEEs)</a><ul>
<li class="chapter" data-level="15.6.1" data-path="gees.html"><a href="gees.html#fitting-gees-with-different-correlation-structures"><i class="fa fa-check"></i><b>15.6.1</b> Fitting GEEs with different correlation structures</a></li>
<li class="chapter" data-level="15.6.2" data-path="gees.html"><a href="gees.html#comparing-different-correlation-structures"><i class="fa fa-check"></i><b>15.6.2</b> Comparing different correlation structures}</a></li>
</ul></li>
<li class="chapter" data-level="15.7" data-path="gees.html"><a href="gees.html#gee-model-assessment"><i class="fa fa-check"></i><b>15.7</b> GEE model assessment</a></li>
<li class="chapter" data-level="15.8" data-path="gees.html"><a href="gees.html#model-selection---which-variables"><i class="fa fa-check"></i><b>15.8</b> Model Selection - Which variables?</a></li>
<li class="chapter" data-level="15.9" data-path="gees.html"><a href="gees.html#prediction-plots-4"><i class="fa fa-check"></i><b>15.9</b> Prediction Plots</a></li>
</ul></li>
<li class="chapter" data-level="16" data-path="correlation-structures.html"><a href="correlation-structures.html"><i class="fa fa-check"></i><b>16</b> Correlation Structures</a><ul>
<li class="chapter" data-level="16.0.1" data-path="correlation-structures.html"><a href="correlation-structures.html#variancecovariance-or-correlation"><i class="fa fa-check"></i><b>16.0.1</b> Variance/Covariance or Correlation?</a></li>
<li class="chapter" data-level="16.0.2" data-path="correlation-structures.html"><a href="correlation-structures.html#example-case"><i class="fa fa-check"></i><b>16.0.2</b> Example Case</a></li>
<li class="chapter" data-level="16.0.3" data-path="correlation-structures.html"><a href="correlation-structures.html#independence"><i class="fa fa-check"></i><b>16.0.3</b> Independence</a></li>
<li class="chapter" data-level="16.0.4" data-path="correlation-structures.html"><a href="correlation-structures.html#acf-example"><i class="fa fa-check"></i><b>16.0.4</b> ACF Example</a></li>
<li class="chapter" data-level="16.0.5" data-path="correlation-structures.html"><a href="correlation-structures.html#exchangeable-block-diagonal"><i class="fa fa-check"></i><b>16.0.5</b> Exchangeable = Block Diagonal</a></li>
<li class="chapter" data-level="16.0.6" data-path="correlation-structures.html"><a href="correlation-structures.html#ar1-first-order-autoregressive-process"><i class="fa fa-check"></i><b>16.0.6</b> AR1 (first-order autoregressive process)</a></li>
<li class="chapter" data-level="16.0.7" data-path="correlation-structures.html"><a href="correlation-structures.html#unstructured"><i class="fa fa-check"></i><b>16.0.7</b> Unstructured</a></li>
</ul></li>
<li class="chapter" data-level="17" data-path="other-model-selection-approaches.html"><a href="other-model-selection-approaches.html"><i class="fa fa-check"></i><b>17</b> Other Model Selection Approaches</a><ul>
<li class="chapter" data-level="17.0.1" data-path="other-model-selection-approaches.html"><a href="other-model-selection-approaches.html#rationale"><i class="fa fa-check"></i><b>17.0.1</b> Rationale</a></li>
<li class="chapter" data-level="17.0.2" data-path="other-model-selection-approaches.html"><a href="other-model-selection-approaches.html#hypotheses"><i class="fa fa-check"></i><b>17.0.2</b> Hypotheses</a></li>
<li class="chapter" data-level="17.1" data-path="other-model-selection-approaches.html"><a href="other-model-selection-approaches.html#backward-selection"><i class="fa fa-check"></i><b>17.1</b> Backward selection</a><ul>
<li class="chapter" data-level="17.1.1" data-path="other-model-selection-approaches.html"><a href="other-model-selection-approaches.html#algorithm"><i class="fa fa-check"></i><b>17.1.1</b> Algorithm</a></li>
<li class="chapter" data-level="17.1.2" data-path="other-model-selection-approaches.html"><a href="other-model-selection-approaches.html#example"><i class="fa fa-check"></i><b>17.1.2</b> Example</a></li>
<li class="chapter" data-level="17.1.3" data-path="other-model-selection-approaches.html"><a href="other-model-selection-approaches.html#cant-this-be-automated"><i class="fa fa-check"></i><b>17.1.3</b> Can’t this be automated?</a></li>
<li class="chapter" data-level="17.1.4" data-path="other-model-selection-approaches.html"><a href="other-model-selection-approaches.html#stepwise-ic-based-selection"><i class="fa fa-check"></i><b>17.1.4</b> Stepwise IC-based selection</a></li>
</ul></li>
<li class="chapter" data-level="17.2" data-path="other-model-selection-approaches.html"><a href="other-model-selection-approaches.html#summary-tables"><i class="fa fa-check"></i><b>17.2</b> Summary tables</a><ul>
<li class="chapter" data-level="17.2.1" data-path="other-model-selection-approaches.html"><a href="other-model-selection-approaches.html#mean-or-sd-median-iqr-etc.-by-groups"><i class="fa fa-check"></i><b>17.2.1</b> Mean (or sd, median, IQR, etc.) by groups</a></li>
<li class="chapter" data-level="17.2.2" data-path="other-model-selection-approaches.html"><a href="other-model-selection-approaches.html#proportions-in-categories-by-groups"><i class="fa fa-check"></i><b>17.2.2</b> Proportions in categories by groups</a></li>
</ul></li>
<li class="chapter" data-level="17.3" data-path="other-model-selection-approaches.html"><a href="other-model-selection-approaches.html#figures"><i class="fa fa-check"></i><b>17.3</b> Figures</a></li>
</ul></li>
<li class="chapter" data-level="18" data-path="gams-generalized-additive-models.html"><a href="gams-generalized-additive-models.html"><i class="fa fa-check"></i><b>18</b> GAMs: Generalized Additive Models</a><ul>
<li class="chapter" data-level="18.1" data-path="gams-generalized-additive-models.html"><a href="gams-generalized-additive-models.html#non-linear-non-monotonic-relationships"><i class="fa fa-check"></i><b>18.1</b> Non-linear, non-monotonic relationships</a></li>
<li class="chapter" data-level="18.2" data-path="gams-generalized-additive-models.html"><a href="gams-generalized-additive-models.html#smooth-terms"><i class="fa fa-check"></i><b>18.2</b> Smooth terms</a><ul>
<li class="chapter" data-level="18.2.1" data-path="gams-generalized-additive-models.html"><a href="gams-generalized-additive-models.html#basis-functions"><i class="fa fa-check"></i><b>18.2.1</b> Basis functions</a></li>
</ul></li>
<li class="chapter" data-level="18.3" data-path="gams-generalized-additive-models.html"><a href="gams-generalized-additive-models.html#fitting-gams"><i class="fa fa-check"></i><b>18.3</b> Fitting GAMs</a><ul>
<li class="chapter" data-level="18.3.1" data-path="gams-generalized-additive-models.html"><a href="gams-generalized-additive-models.html#choosing-model-formulation"><i class="fa fa-check"></i><b>18.3.1</b> Choosing model formulation</a></li>
<li class="chapter" data-level="18.3.2" data-path="gams-generalized-additive-models.html"><a href="gams-generalized-additive-models.html#model-formula"><i class="fa fa-check"></i><b>18.3.2</b> Model formula</a></li>
</ul></li>
<li class="chapter" data-level="18.4" data-path="gams-generalized-additive-models.html"><a href="gams-generalized-additive-models.html#model-assessment-6"><i class="fa fa-check"></i><b>18.4</b> Model Assessment</a><ul>
<li class="chapter" data-level="18.4.1" data-path="gams-generalized-additive-models.html"><a href="gams-generalized-additive-models.html#concurvity"><i class="fa fa-check"></i><b>18.4.1</b> Concurvity</a></li>
</ul></li>
<li class="chapter" data-level="18.5" data-path="gams-generalized-additive-models.html"><a href="gams-generalized-additive-models.html#model-selection-3"><i class="fa fa-check"></i><b>18.5</b> Model Selection</a><ul>
<li class="chapter" data-level="18.5.1" data-path="gams-generalized-additive-models.html"><a href="gams-generalized-additive-models.html#shrinkage-and-penalties"><i class="fa fa-check"></i><b>18.5.1</b> Shrinkage and Penalties</a></li>
<li class="chapter" data-level="18.5.2" data-path="gams-generalized-additive-models.html"><a href="gams-generalized-additive-models.html#p-value-selection"><i class="fa fa-check"></i><b>18.5.2</b> P-value selection</a></li>
<li class="chapter" data-level="18.5.3" data-path="gams-generalized-additive-models.html"><a href="gams-generalized-additive-models.html#information-criteria"><i class="fa fa-check"></i><b>18.5.3</b> Information criteria</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i>References</a></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">STAT 245 Course Notes</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="non-constant-variance-and-other-unresolved-problems" class="section level1">
<h1><span class="header-section-number">Chapter 13</span> Non-constant variance (and other unresolved problems)</h1>
<p>So far, we have worked to assemble a tool-kit that allows us to fit appropriate regression models for a variety of types of response and predictor variables. If we fit an appropriate model (conditions are met) to an appropriate dataset (representative sample of the population of interest), we should be able to draw valid conclusions – but as we have seen, if conditions are <em>not</em> met, then our conclusions (model predictions, judgements about which predictors are important, etc.) may all be unreliable.</p>
<p>So what can we do if we’ve fit the best model we know how to fit, and it’s still not quite right? We have seen a number of examples so far where, even after we fit a model with what seem to be the right family and sensible predictors, conditions are not met. The most common problems are non-constant variance of residuals (often seen with non-normal residuals), and non-independent residuals. Solutions for non-independent residuals are coming soon, in future sections. Here we’ll review options (some already in our tool-kit, and some new) to try to improve the situation when non-constant variance (NCV) is present.</p>
<p>What can we try if a model seems to fit data well, except for the fact that the constant variance condition doesn’t hold (for linear regression) or the mean-variance relationship is not as expected (GLMs etc.)? (Note: this problem is also often accompanied by right skew in the distribution of the residuals.) Possible solutions are presented approximately in order of desirability…</p>
<div id="already-in-our-tool-box-make-sure-the-model-is-right" class="section level3">
<h3><span class="header-section-number">13.0.1</span> Already in Our Tool Box: Make sure the model is “right”</h3>
<p>Improving the model specification sometimes corrects a problem with non-constant variance. Make sure you have considered:</p>
<ul>
<li>Is the right “family” being used for the data type being modelled?</li>
<li>Are <strong>all</strong> the variables that you think are important predictors (and are available to you in the data) included in the model?
<!-- If there is a need for random effects (or GEE clusters), are they included in the model? --></li>
</ul>
</div>
<div id="already-in-our-tool-box-models-that-estimate-dispersion-parameters" class="section level3">
<h3><span class="header-section-number">13.0.2</span> Already in Our Tool Box: Models that estimate dispersion parameters</h3>
<p>Negative binomial (and quasi-Poisson) models include estimation of a dispersion parameter that helps to account for over- or under-disperion (that is - the variance is larger, or smaller, than the mean value). If one of these models is being used (or is appropriate for the data) - NCV should be accounted for! (We can also verify this: If all is working well, the Pearson residuals will have constant variance.)</p>
</div>
<div id="gamma-glms" class="section level3">
<h3><span class="header-section-number">13.0.3</span> Gamma GLMs</h3>
<p><strong>If</strong> you are fitting a linear regression and:</p>
<ul>
<li>The response variable of interest is non-negative, <strong>and</strong></li>
<li>There is right skew in residuals <strong>and/or</strong></li>
<li>There is non-constant variance of residuals…</li>
</ul>
<p>You may want to try fitting a model using the <strong>Gamma</strong> family (<code>link = 'log'</code> or <code>link = 'inverse'</code> link functions are the most common). If needed you can use model assessment plots and/or model selection criteria (AIC, BIC…) to decide between link functions. For example:</p>
<div class="sourceCode" id="cb181"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb181-1" title="1">gamma.mod &lt;-<span class="st"> </span><span class="kw">glm</span>(resp <span class="op">~</span><span class="st"> </span>pred1 <span class="op">+</span><span class="st"> </span>pred2, <span class="dt">data=</span>dataset,</a>
<a class="sourceLine" id="cb181-2" title="2">                 <span class="dt">family=</span><span class="kw">Gamma</span>(<span class="dt">link=</span><span class="st">&#39;log&#39;</span>)) <span class="co"># or can use link=&#39;inverse&#39;</span></a></code></pre></div>
</div>
<div id="beta-glms" class="section level3">
<h3><span class="header-section-number">13.0.4</span> Beta GLMs</h3>
<p>If your response variable happens to be bounded between 0-1 (but NOT a probability, so that a binary data regression would not be appropriate), you can also try a Beta regression (using the beta distribution). Since the shape of the distribution is extremely flexible, it will help with residuals whose distribution is not as expected. The variance of the beta distribution also <em>does</em> depend on its mean, so it is likely to be better than a linear model at addressing NCV. A code example is below. You must use <code>glmmTMB()</code> to fit this model.</p>
<div class="sourceCode" id="cb182"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb182-1" title="1">beta_model &lt;-<span class="st"> </span><span class="kw">glmmTMB</span>(response <span class="op">~</span><span class="st"> </span>predictor1 <span class="op">+</span><span class="st"> </span>predictor2,</a>
<a class="sourceLine" id="cb182-2" title="2">                      <span class="dt">data=</span>my_data,</a>
<a class="sourceLine" id="cb182-3" title="3">                      <span class="dt">family=</span><span class="kw">beta_family</span>(<span class="dt">link=</span><span class="st">&#39;logit&#39;</span>))</a></code></pre></div>
</div>
<div id="transformations" class="section level3">
<h3><span class="header-section-number">13.0.5</span> Transformations</h3>
<p>In some cases, a logarithmic or square-root transformation of the <strong>response variable</strong> can correct a problem with the variance of the residuals. This is most sensible as a solution if the <code>log(variable)</code> or <code>sqrt(variable)</code> makes some “sense” to a human…for example, if the response variable is <code>wages</code> in dollars, then <code>log10(wages)</code> is kind of the order of magnitude of the salary, which makes some sense as a measure of income. Another example: sound pressure is measured in <span class="math inline">\(\mu Pa\)</span>, but we perceive sound logarithmically, so that a sound that has 10 times greater pressure “sounds” about twice as loud. So <code>log10(sound_pressure)</code> could be a sensible metric.</p>
<p>Why does this work? These transformations don’t affect the magnitude of <em>small</em> residual values very much, but they make <em>large</em> residuals get <em>a lot</em> smaller. The result is that the histogram of residuals has less right skew and the large-magnitude residuals (the ones causing the “flare” of the “trumpet” in the residuals vs. fitted plot) get much smaller.</p>
<p><img src="s245-notes_files/figure-html/unnamed-chunk-98-1.png" width="211.2" style="display: block; margin: auto;" /><img src="s245-notes_files/figure-html/unnamed-chunk-98-2.png" width="211.2" style="display: block; margin: auto;" /><img src="s245-notes_files/figure-html/unnamed-chunk-98-3.png" width="211.2" style="display: block; margin: auto;" /></p>
</div>
<div id="modelling-non-constant-variance" class="section level3">
<h3><span class="header-section-number">13.0.6</span> Modelling non-constant variance</h3>
<p>If your model is a linear regression, then there are a few specialized fitting functions that can allow you to fit models with non-constant variance of the residuals.</p>
<p>For multiple linear regression (original fit with <strong>lm()</strong>), you can use <strong>gls()</strong> from package <strong>nlme</strong> and add input <em>weights=varPower()</em> – inputs are otherwise the same as for <strong>lm()</strong>.</p>
<div class="sourceCode" id="cb183"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb183-1" title="1"><span class="kw">require</span>(nlme)</a>
<a class="sourceLine" id="cb183-2" title="2"><span class="kw">nls</span>(response <span class="op">~</span><span class="st"> </span>pred1 <span class="op">+</span><span class="st"> </span>pred2, <span class="dt">data=</span>dataset,</a>
<a class="sourceLine" id="cb183-3" title="3">    <span class="dt">weights=</span><span class="kw">varPower</span>())</a></code></pre></div>
<!-- For random effects models fitted via **lmer()**, similar options are available, setting input *weights=varPower()* or (to allow different variance in each random effect group, or each group of another categorical variable) *weights = varIdent(form= ~1|categorical.variable)*. -->
<!-- ```{r, eval=FALSE, echo=TRUE} -->
<!-- require(lme4) -->
<!-- # variance increases with some power of fitted value -->
<!-- lmer(response ~ pred1 + pred2 + (~1|ID), data=dataset, -->
<!--     weights=varPower()) -->
<!-- # variance is different for each level of random effect: -->
<!-- lmer(response ~ pred1 + pred2 + (~1|ID), data=dataset, -->
<!--     weights=varIdent(form=~1|ID)) -->
<!-- ``` -->
<p><em>If you’re interested in learning more about this method (and other options for specification of the form of the non-constant variance), see the references below in R (you will not be held responsible for the information contained in these help files for STAT 245 - just provided for further reference.)</em></p>
<div class="sourceCode" id="cb184"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb184-1" title="1">?nlme<span class="op">::</span>nls</a>
<a class="sourceLine" id="cb184-2" title="2">?nlme<span class="op">::</span>varClasses</a></code></pre></div>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="zero-inflation.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="random-effects.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"google": false,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "google", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/rstudio/bookdown-demo/edit/master/13-NCV.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"download": ["s245-notes.pdf", "s245-notes.epub"],
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
